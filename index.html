<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
 
  body{
  font-family:system-ui,-apple-system,sans-serif;
  background:#f4f6f8;
  margin:0;
  padding:20px;
}

.container{
  width:100%;
  max-width:none;
  padding:0 16px;
  box-sizing:border-box;
}

.card{
  background:white;
  border-radius:16px;
  overflow:hidden;
  margin-bottom:20px;
  box-shadow:0 6px 18px rgba(0,0,0,.08);
  transition:.2s;
  height:100%;
  display:flex;
  flex-direction:column;
   }
.content{
  padding:24px;
  flex:1;
  display:flex;
  flex-direction:column;
}
.card:hover{
  transform:translateY(-4px);
  box-shadow:0 10px 26px rgba(0,0,0,.12);
}

.img{
  width:100%;
  aspect-ratio:16/9;
  object-fit:cover;
  display:block;
}

.content{
  padding:18px;
}
.btn{
  margin-top:auto;
  display:block;
  text-align:center;
  padding:12px 16px;
  background:black;
  color:white;
  border-radius:10px;
  font-size:14px;
  text-decoration:none;
}
.title{
  font-size:22px;
  font-weight:700;
  line-height:1.25;
  margin-bottom:10px;
}

.meta{
  color:#666;
  font-size:14px;
  margin-bottom:6px;
}

.price{
  font-weight:600;
  margin-top:6px;
}

.badge{
  display:inline-block;
  padding:4px 8px;
  background:#ff4d4f;
  color:white;
  font-size:12px;
  border-radius:6px;
  margin-top:8px;
}

.countdown{
  font-size:13px;
  margin-top:6px;
  color:#444;
}

.month-title{
  font-size:28px;
  margin:50px 0 20px;
  font-weight:800;
}

.month-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(420px,1fr));
  gap:32px;
}
  .month-section{
  width:100%;
  margin-bottom:60px;
}
</style>
</head>

<body>

<div class="container" id="events">
Loading events...
</div>

<script>
fetch("https://fienta.com/api/v1/public/events?organizer=27119")
.then(r=>r.json())
.then(data=>{

  const container=document.getElementById("events");

  // sort events by date
  const events = data.events.sort((a,b)=>
    new Date(a.starts_at)-new Date(b.starts_at)
  );

  // group by month
  const grouped = {};

  events.forEach(ev=>{
    const date = new Date(ev.starts_at);
    const key = date.toLocaleString("default",{month:"long", year:"numeric"});

    if(!grouped[key]) grouped[key]=[];
    grouped[key].push(ev);
  });

  container.innerHTML="";

  // render months
  Object.keys(grouped).forEach(month=>{

    const section=document.createElement("div");
    section.className="month-section";

    section.innerHTML=`
      <h2 class="month-title">${month}</h2>
      <div class="month-grid"></div>
    `;

    container.appendChild(section);

    const grid = section.querySelector(".month-grid");

    grouped[month].forEach(ev=>{

      const start = new Date(ev.starts_at);

      const date = start.toLocaleString(undefined,{
        weekday:"short",
        day:"numeric",
        month:"short",
        hour:"2-digit",
        minute:"2-digit"
      });

      let countdown="";
      const diff = start - new Date();
      if(diff>0){
        const days=Math.floor(diff/86400000);
        const hours=Math.floor(diff/3600000)%24;
        countdown=`Starts in ${days}d ${hours}h`;
      }

      const soldOut = ev.sale_status !== "onSale";

      const card=document.createElement("div");
      card.className="card";

      card.innerHTML=`
        ${ev.image_url ? `<img src="${ev.image_url}" class="img">` : ""}
        <div class="content">
          <div class="title">${ev.title}</div>
          <div class="meta">${date}</div>
          ${ev.venue ? `<div class="meta">${ev.venue}</div>` : ""}
          <div class="price">See tickets for price</div>
          ${countdown ? `<div class="countdown">${countdown}</div>`:""}
          ${soldOut ? `<div class="badge">Sold Out</div>`:""}
          <a href="${ev.buy_tickets_url}" target="_blank" class="btn">View Event</a>
        </div>
      `;

      grid.appendChild(card);
    });

  });

});
</script>

</body>
</html>
